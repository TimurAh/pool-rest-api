# Pool REST API

REST API для управления бронированиями в бассейне.

Реализовано на **Spring Boot 3** + **JPA/Hibernate** + **PostgreSQL**.

## Функционал

### Обязательные требования (реализовано)
- Регистрация и управление клиентами
- Бронирование слотов по часам (дискретизация 1 час)
- Ограничение на количество записей в час (макс. 10 человек — проверяется через график)
- Возможность записаться только на рабочее время (проверка по графику)

### Дополнительно (реализовано частично)
- Поиск броней по дате
- График работы по дням недели (`RegularDateSchedule`)
- Структура для поддержки праздничных дней (`Holidays`)
- Отмена брони

### Не реализовано
- Ограничение 1 посещение в день на человека
- Запись на несколько часов подряд
- Полная интеграция праздников в логику доступности
- Поиск по подстроке имени клиента (регистронезависимый)

## Технологии

- Spring Boot 3
- Spring Data JPA (Hibernate)
- PostgreSQL
- Lombok (частично)
- Maven

## Запуск
При первом запуске автоматически создаются:

Тестовые клиенты
График работы по дням недели

Настройте подключение к PostgreSQL в src/main/resources/application.properties, если требуется.
```bash
git clone https://github.com/TimurAh/pool-rest-api.git
cd pool-rest-api
./mvnw spring-boot:run
```
## Эндпоинты
### Клиенты

- GET /api/v0/pool/client/all — список всех клиентов (кратко: id + name)
- GET /api/v0/pool/client/get/{id} — детальная информация о клиенте
- POST /api/v0/pool/client/add — создать клиента (валидация email и телефона)
- DELETE /api/v0/pool/client/delete/{id} — удалить клиента

### Бронирования

- GET /api/v0/pool/timetable/all?date=2025-12-30 — занятые слоты на указанную дату (время + количество броней)
- POST /api/v0/pool/timetable/reserve — создать бронь
- POST /api/v0/pool/timetable/cancel — отменить бронь

## Структура таблиц в БД

### clients
| Колонка   | Тип              | Описание                     | Ограничения                     |
|-----------|------------------|------------------------------|---------------------------------|
| id        | bigint           | Идентификатор клиента        | PK, автоинкремент               |
| name      | varchar(255)     | ФИО клиента                  | NOT NULL                        |
| email     | varchar(255)     | Email                        | NOT NULL, UNIQUE                |
| phone     | varchar(255)     | Телефон                      | NOT NULL                        |

### reservations_pool
| Колонка          | Тип              | Описание                          | Ограничения                     |
|------------------|------------------|-----------------------------------|---------------------------------|
| id               | bigint           | Идентификатор брони               | PK, автоинкремент               |
| client_id        | bigint           | Ссылка на клиента                 | FK → clients.id, NOT NULL       |
| reservation_date | date             | Дата посещения                    | NOT NULL                        |
| start_time       | time             | Время начала слота                | NOT NULL                        |
| end_time         | time             | Время окончания слота             | NOT NULL                        |
| status           | varchar(255)     | Статус брони (APPROVED, CANCELLED)| NOT NULL                        |

### regular_date_schedule
| Колонка      | Тип              | Описание                          | Ограничения                     |
|--------------|------------------|-----------------------------------|---------------------------------|
| id           | bigint           | Идентификатор                     | PK, автоинкремент               |
| day_of_week  | varchar(255)     | День недели (MONDAY..SUNDAY)      | NOT NULL, UNIQUE                |
| open_time    | time             | Время открытия                    |                                 |
| close_time   | time             | Время закрытия                    |                                 |
| max_slots    | bigint           | Максимальное количество человек в час | NOT NULL                   |
| is_work      | boolean          | Работает ли бассейн в этот день   | NOT NULL                        |

### holidays
| Колонка         | Тип              | Описание                          | Ограничения                     |
|-----------------|------------------|-----------------------------------|---------------------------------|
| id              | bigint           | Идентификатор                     | PK, автоинкремент               |
| holiday_title   | varchar(255)     | Название праздника                |                                 |
| date_holidays   | date             | Дата праздника                    | UNIQUE                          |
| open_time       | time             | Время открытия (наследуется)      |                                 |
| close_time      | time             | Время закрытия (наследуется)      |                                 |
| max_slots       | bigint           | Максимальное количество человек   |                                 |
| is_work         | boolean          | Открыт ли бассейн в праздник      |                                 |